<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/admin}">
<head>
    <title>KCISA 문화포털 통합관리시스템</title>
    <script type="text/javascript">
        $(function () {

            var frm = $('form[name=frm]');
            var page_no = frm.find('input[name=page_no]');
            var search_date_start = frm.find('input[name=search_start]');
            var search_date_end = frm.find('input[name=search_end]');
            /* var creators = frm.find('input[name=creators]');
            var approval = frm.find('input[name=approval]');
            var reg_date_start = frm.find('inpput[name=reg_date_start]');
            var reg_date_end = frm.find('inpput[name=reg_date_end]');
            var insert_date_start = frm.find('inpput[name=insert_date_start]');
            var insert_date_end = frm.find('inpput[name=insert_date_end]');
            var search_type = frm.find('select[name=search_type]');
            var search_word = frm.find('inpput[name=search_word]'); */

            //layout

            // alert('[[${paramMap.page_no}]]');
            if('[[${paramMap[sort_type]}]]') {
                if('${paramMap.sort_type}' == 'hit'){
                    $('ul.sortingList li').removeClass('on');
                    $('ul.sortingList li:eq(1)').addClass('on');
                }
            }

            new Datepicker(search_date_start, search_date_end);

            //paging
            var p = new Pagination({
                view		:	'#pagination',
                page_count	:	'[[${count }]]',
                page_no		:	'${paramMap.page_no }',
                /* link		:	'/main/code/list.do?page_no=__id__', */
                callback	:	function(pageIndex, e) {
                    page_no.val(pageIndex + 1);
                    search();
                    return false;
                }
            });

            //radio check
            if('${paramMap.state}')
                $('input:radio[name="state"][value="${paramMap.state}"]').prop('checked', 'checked');

            //checkbox
            new Checkbox('input[name=uciAll]', 'input[name=uci]');

            //selectbox
            if('${paramMap.approval}')$("select[name=approval]").val('${paramMap.approval}').attr("selected", "selected");
            if('${paramMap.period}')$("select[name=period]").val('${paramMap.period}').attr("selected", "selected");
            if('${paramMap.searchGubun}')$("select[name=searchGubun]").val('${paramMap.searchGubun}').attr("selected", "selected");

            // radio 변경
            // if('${paramMap.office}')$("select[name=office]").val('${paramMap.office}').attr("selected", "selected");

            //검색
            $('button[name=searchButton]').click(function(){
                $('input[name=page_no]').val('1');
                $('form[name=frm]').submit();
            });

            search = function() {
                frm.submit();
            }

            //상세
            $('div.tableList table tbody tr td').each(function() {
                if(!$(this).find('input').attr('type')){
                    $(this).click(function(){
                        view($(this).parent().first().find('input').attr('type' , 'checkbox').val());
                    });
                }
            });

            show = function(menu_cd , seq) {
                location.href('/common/reply/list.do?rUrl=/perform/show/list.do&menu_cd=' + menu_cd + '&amp;seq=' + seq);

                return false;
            };

            //최신순 , 조회순
            $('div.topBehavior ul li a').each(function() {
                $(this).click(function() {
                    if($(this).html() == '최신순') {
                        $('input[name=sort_type]').val('latest');
                        search();
                    } else if($(this).html() == '조회순') {
                        $('input[name=sort_type]').val('hit');
                        search();
                    }
                });
            });

            // 등록, 상세
            $('span.btn.dark.fr').click(function(){
                view();
            });

            //승인 , 미승인 , 삭제 이벤트
            $('span > button').each(function() {
                $(this).click(function() {
                    if($(this).html() == '삭제') {
                        if (!confirm('삭제 하시겠습니까?')) {
                            return false;
                        }
                        deleteSites();
                    } else if($(this).html() == '승인') {
                        if (!confirm('승인 처리 하시겠습니까?')) {
                            return false;
                        }
                        $('input[name=updateStatus]').val('Y');
                        updateStatus();
                    } else if($(this).html() == '미승인') {
                        if (!confirm('미승인 처리 하시겠습니까?')) {
                            return false;
                        }
                        $('input[name=updateStatus]').val('N');
                        updateStatus();
                    }
                });
            });

            //승인 , 미승인
            updateStatus = function () {

                if(getCheckBoxCheckCnt() == 0) {
                    if($('input[name=updateStatus]').val() == 'N')
                        alert('미승인할 코드를 선택하세요');
                    if($('input[name=updateStatus]').val() == 'Y')
                        alert('승인할 코드를 선택하세요');
                    return false;
                }

                formSubmit('/perform/show/statusUpdate.do');
            }

            //삭제
            deleteSites = function () {

                if(getCheckBoxCheckCnt() == 0) {
                    alert('삭제할 코드를 선택하세요');
                    return false;
                }

                formSubmit('/perform/show/delete.do');
            }

            //체크 박스 count 수
            getCheckBoxCheckCnt = function() {
                return $('input[name=uci]:checked').length;
            };

            //submit
            formSubmit = function (url) {
                frm.attr('action' , url);
                frm.submit();
            };
        });

    </script>
</head>
<body>
    <div id="contents" layout:fragment="contents" th:with="currentMenu=${currentMenu}">
        <!--/* content_header 시작 */-->
        <th:block th:replace="~{layout/fragments/contentHeader :: contentHeader}"></th:block>
        <!--/* content_header 끝 */-->
        <div class="cont_box">




            <div id="pagination">
            </div>



        </div>

    </div>
</body>
</html>